view: categories {
  derived_table: {
    sql:  SELECT bus.business_id AS business_id, split_categories
          FROM yelp_new.business AS bus
          LEFT JOIN UNNEST(SPLIT(bus.categories)) AS split_categories ;;
  }

  dimension: business_id {
    type: number
    hidden: yes
    sql: ${TABLE}.business_id ;;
  }

  dimension: split_categories {
    type: string
    sql: TRIM(${TABLE}.split_categories) ;;
    link: {
      label: "Comparison Dashboard"
      url: "/dashboards/426?Food Category={{ value }}"
      icon_url: "data:image/png;base64,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"
      # Icon made by Freepik from flaticon.com
    }
  }

  dimension: primary_key_concat {
    type: string
    primary_key: yes
    hidden: yes
    sql: CONCAT(CAST(${business_id} AS STRING), '-', categories);;
  }
}
